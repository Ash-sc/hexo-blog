<!DOCTYPE html>
<html lang=zh>
<head><meta name="generator" content="Hexo 3.8.0">
    <!-- so meta -->
    <meta charset="utf-8">
    <meta http-equiv="X-UA-Compatible" content="IE=edge">
    <meta name="HandheldFriendly" content="True">
    <meta name="viewport" content="width=device-width, initial-scale=1, maximum-scale=1">
    <meta name="description" content="今天在公交车上的时候，某K给我发了一道前端面试题让我解答。 然后， 我看第一眼的时候，被绕了进去……(╯-_-)╯~╩╩ 多了一个slice(0)题目如下，问两段代码console的结果有什么区别：123456789101112131415161718192021// 第一段代码var arr = [0,1,2,3,4,5,6,7,8,9];var res = [0,0,0,0,0,0,0,0,0">
<meta name="keywords" content="前端,面试题">
<meta property="og:type" content="article">
<meta property="og:title" content="一道前端面试题">
<meta property="og:url" content="http://yoursite.com/2018/04/27/fe-question/index.html">
<meta property="og:site_name" content="Ash&#39;s Folding Page">
<meta property="og:description" content="今天在公交车上的时候，某K给我发了一道前端面试题让我解答。 然后， 我看第一眼的时候，被绕了进去……(╯-_-)╯~╩╩ 多了一个slice(0)题目如下，问两段代码console的结果有什么区别：123456789101112131415161718192021// 第一段代码var arr = [0,1,2,3,4,5,6,7,8,9];var res = [0,0,0,0,0,0,0,0,0">
<meta property="og:locale" content="zh-CN">
<meta property="og:image" content="http://web-site-files.ashshen.cc/blog/font-end-question/run-result.png">
<meta property="og:image" content="http://web-site-files.ashshen.cc/blog/font-end-question/arr-sort.png">
<meta property="og:image" content="http://web-site-files.ashshen.cc/blog/font-end-question/final-result.png">
<meta property="og:updated_time" content="2018-11-27T10:11:21.396Z">
<meta name="twitter:card" content="summary">
<meta name="twitter:title" content="一道前端面试题">
<meta name="twitter:description" content="今天在公交车上的时候，某K给我发了一道前端面试题让我解答。 然后， 我看第一眼的时候，被绕了进去……(╯-_-)╯~╩╩ 多了一个slice(0)题目如下，问两段代码console的结果有什么区别：123456789101112131415161718192021// 第一段代码var arr = [0,1,2,3,4,5,6,7,8,9];var res = [0,0,0,0,0,0,0,0,0">
<meta name="twitter:image" content="http://web-site-files.ashshen.cc/blog/font-end-question/run-result.png">
    
    
        
          
              <link rel="shortcut icon" href="/images/favicon.ico">
          
        
        
          
            <link rel="icon" type="image/png" href="/images/favicon-192x192.png" sizes="192x192">
          
        
        
          
            <link rel="apple-touch-icon" sizes="180x180" href="/images/apple-touch-icon.png">
          
        
    
    <!-- title -->
    <title>一道前端面试题</title>
    <!-- styles -->
    <link rel="stylesheet" href="/css/style.css">
    <!-- persian styles -->
    
      <link rel="stylesheet" href="/css/rtl.css">
    
    <!-- rss -->
    
    
</head>

<body class="max-width mx-auto px3 ltr">
    
      <div id="header-post">
  <a id="menu-icon" href="#"><i class="fas fa-bars fa-lg"></i></a>
  <a id="menu-icon-tablet" href="#"><i class="fas fa-bars fa-lg"></i></a>
  <a id="top-icon-tablet" href="#" onclick="$('html, body').animate({ scrollTop: 0 }, 'fast');" style="display:none;"><i class="fas fa-chevron-up fa-lg"></i></a>
  <span id="menu">
    <span id="nav">
      <ul>
         
          <li><a href="/">首页</a></li>
         
          <li><a href="/about/">关于</a></li>
         
          <li><a href="/archives/">归档</a></li>
         
          <li><a href="/projects_url">项目</a></li>
        
      </ul>
    </span>
    <br>
    <span id="actions">
      <ul>
        
        <li><a class="icon" href="/2018/08/23/file-slice-upload-node/"><i class="fas fa-chevron-left" aria-hidden="true" onmouseover="$('#i-prev').toggle();" onmouseout="$('#i-prev').toggle();"></i></a></li>
        
        
        <li><a class="icon" href="/2018/04/04/fe-note/"><i class="fas fa-chevron-right" aria-hidden="true" onmouseover="$('#i-next').toggle();" onmouseout="$('#i-next').toggle();"></i></a></li>
        
        <li><a class="icon" href="#" onclick="$('html, body').animate({ scrollTop: 0 }, 'fast');"><i class="fas fa-chevron-up" aria-hidden="true" onmouseover="$('#i-top').toggle();" onmouseout="$('#i-top').toggle();"></i></a></li>
        <li><a class="icon" href="#"><i class="fas fa-share-alt" aria-hidden="true" onmouseover="$('#i-share').toggle();" onmouseout="$('#i-share').toggle();" onclick="$('#share').toggle();return false;"></i></a></li>
      </ul>
      <span id="i-prev" class="info" style="display:none;">上一篇</span>
      <span id="i-next" class="info" style="display:none;">下一篇</span>
      <span id="i-top" class="info" style="display:none;">返回顶部</span>
      <span id="i-share" class="info" style="display:none;">分享文章</span>
    </span>
    <br>
    <div id="share" style="display: none">
      <ul>
  <li><a class="icon" href="http://www.facebook.com/sharer.php?u=http://yoursite.com/2018/04/27/fe-question/"><i class="fab fa-facebook " aria-hidden="true"></i></a></li>
  <li><a class="icon" href="https://twitter.com/share?url=http://yoursite.com/2018/04/27/fe-question/&text=一道前端面试题"><i class="fab fa-twitter " aria-hidden="true"></i></a></li>
  <li><a class="icon" href="http://www.linkedin.com/shareArticle?url=http://yoursite.com/2018/04/27/fe-question/&title=一道前端面试题"><i class="fab fa-linkedin " aria-hidden="true"></i></a></li>
  <li><a class="icon" href="https://pinterest.com/pin/create/bookmarklet/?url=http://yoursite.com/2018/04/27/fe-question/&is_video=false&description=一道前端面试题"><i class="fab fa-pinterest " aria-hidden="true"></i></a></li>
  <li><a class="icon" href="mailto:?subject=一道前端面试题&body=Check out this article: http://yoursite.com/2018/04/27/fe-question/"><i class="fas fa-envelope " aria-hidden="true"></i></a></li>
  <li><a class="icon" href="https://getpocket.com/save?url=http://yoursite.com/2018/04/27/fe-question/&title=一道前端面试题"><i class="fab fa-get-pocket " aria-hidden="true"></i></a></li>
  <li><a class="icon" href="http://reddit.com/submit?url=http://yoursite.com/2018/04/27/fe-question/&title=一道前端面试题"><i class="fab fa-reddit " aria-hidden="true"></i></a></li>
  <li><a class="icon" href="http://www.stumbleupon.com/submit?url=http://yoursite.com/2018/04/27/fe-question/&title=一道前端面试题"><i class="fab fa-stumbleupon " aria-hidden="true"></i></a></li>
  <li><a class="icon" href="http://digg.com/submit?url=http://yoursite.com/2018/04/27/fe-question/&title=一道前端面试题"><i class="fab fa-digg " aria-hidden="true"></i></a></li>
  <li><a class="icon" href="http://www.tumblr.com/share/link?url=http://yoursite.com/2018/04/27/fe-question/&name=一道前端面试题&description="><i class="fab fa-tumblr " aria-hidden="true"></i></a></li>
</ul>

    </div>
    <div id="toc">
      <ol class="toc"><li class="toc-item toc-level-2"><a class="toc-link" href="#多了一个slice-0"><span class="toc-number">1.</span> <span class="toc-text">多了一个slice(0)</span></a></li><li class="toc-item toc-level-2"><a class="toc-link" href="#sort-和Math-random"><span class="toc-number">2.</span> <span class="toc-text">sort()和Math.random()</span></a></li></ol>
    </div>
  </span>
</div>

    
    <div class="content index py4">
        
        <article class="post" itemscope="" itemtype="http://schema.org/BlogPosting">
  <header>
    
    <h1 class="posttitle" itemprop="name headline">
        一道前端面试题
    </h1>



    <div class="meta">
      <span class="author" itemprop="author" itemscope="" itemtype="http://schema.org/Person">
        <span itemprop="name">Ash's Folding Page</span>
      </span>
      
    <div class="postdate">
        <time datetime="2018-04-27T12:46:03.000Z" itemprop="datePublished">2018-04-27</time>
    </div>


      

      
    <div class="article-tag">
        <i class="fas fa-tag"></i>
        <a class="tag-link" href="/tags/前端/">前端</a>, <a class="tag-link" href="/tags/面试题/">面试题</a>
    </div>


    </div>
  </header>
  

  <div class="content" itemprop="articleBody">
    <p>今天在公交车上的时候，某K给我发了一道前端面试题让我解答。</p>
<p>然后， 我看第一眼的时候，被绕了进去……(╯-_-)╯~╩╩</p>
<h2 id="多了一个slice-0"><a href="#多了一个slice-0" class="headerlink" title="多了一个slice(0)"></a>多了一个slice(0)</h2><p>题目如下，问两段代码console的结果有什么区别：<br><figure class="highlight js"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br></pre></td><td class="code"><pre><span class="line"><span class="comment">// 第一段代码</span></span><br><span class="line"><span class="keyword">var</span> arr = [<span class="number">0</span>,<span class="number">1</span>,<span class="number">2</span>,<span class="number">3</span>,<span class="number">4</span>,<span class="number">5</span>,<span class="number">6</span>,<span class="number">7</span>,<span class="number">8</span>,<span class="number">9</span>];</span><br><span class="line"><span class="keyword">var</span> res = [<span class="number">0</span>,<span class="number">0</span>,<span class="number">0</span>,<span class="number">0</span>,<span class="number">0</span>,<span class="number">0</span>,<span class="number">0</span>,<span class="number">0</span>,<span class="number">0</span>,<span class="number">0</span>];</span><br><span class="line"><span class="keyword">var</span> t = <span class="number">1000</span>;</span><br><span class="line"><span class="keyword">for</span>(<span class="keyword">var</span> i = <span class="number">0</span>; i &lt; t; i++)&#123;</span><br><span class="line">  <span class="keyword">var</span> sorted = arr.slice(<span class="number">0</span>).sort(<span class="function"><span class="params">()</span> =&gt;</span> <span class="built_in">Math</span>.random() - <span class="number">0.5</span>);</span><br><span class="line">  sorted.forEach(<span class="function">(<span class="params">o,i</span>) =&gt;</span> res[i] += o);</span><br><span class="line">&#125;</span><br><span class="line">res = res.map(<span class="function"><span class="params">o</span> =&gt;</span> o / t);</span><br><span class="line"><span class="built_in">console</span>.log(res);</span><br><span class="line"></span><br><span class="line"><span class="comment">// 第二段代码</span></span><br><span class="line"><span class="keyword">var</span> arr = [<span class="number">0</span>,<span class="number">1</span>,<span class="number">2</span>,<span class="number">3</span>,<span class="number">4</span>,<span class="number">5</span>,<span class="number">6</span>,<span class="number">7</span>,<span class="number">8</span>,<span class="number">9</span>];</span><br><span class="line"><span class="keyword">var</span> res = [<span class="number">0</span>,<span class="number">0</span>,<span class="number">0</span>,<span class="number">0</span>,<span class="number">0</span>,<span class="number">0</span>,<span class="number">0</span>,<span class="number">0</span>,<span class="number">0</span>,<span class="number">0</span>];</span><br><span class="line"><span class="keyword">var</span> t = <span class="number">1000</span>;</span><br><span class="line"><span class="keyword">for</span>(<span class="keyword">var</span> i = <span class="number">0</span>; i &lt; t; i++)&#123;</span><br><span class="line">  <span class="keyword">var</span> sorted = arr.sort(<span class="function"><span class="params">()</span> =&gt;</span> <span class="built_in">Math</span>.random() - <span class="number">0.5</span>);</span><br><span class="line">  sorted.forEach(<span class="function">(<span class="params">o,i</span>) =&gt;</span> res[i] += o);</span><br><span class="line">&#125;</span><br><span class="line">res = res.map(<span class="function"><span class="params">o</span> =&gt;</span> o / t);</span><br><span class="line"><span class="built_in">console</span>.log(res);</span><br></pre></td></tr></table></figure></p>
<p>说实话，第一眼看到的时候，我觉得这两段代码的执行结果并不会有什么区别。</p>
<p>然而，真实的执行结果：</p>
<p><img src="http://web-site-files.ashshen.cc/blog/font-end-question/run-result.png" alt="console-output"></p>
<p>两份代码唯一的区别在于第一份代码多了一个<code>slice(0)</code>。</p>
<p>首先我们需要知道：<strong>数组的sort方法是会改变源数组的，并且会返回排序后的数组；而slice(0)则是返回一个浅拷贝的新数组</strong>。</p>
<p>所以，第一份代码中：1000次循环，每一次得到的<code>sorted</code>都基于[0, 1, 2, 3, 4, 5, 6, 7, 8, 9]；而第二份代码中：1000次循环，每一次得到的<code>sorted</code>都基于前一次循环后的<code>sorted</code>。</p>
<p>那么，为什么第一份代码得到的res数组元素会是依次递增，而第二份代码得到的res数组元素是相似的值呢？</p>
<h2 id="sort-和Math-random"><a href="#sort-和Math-random" class="headerlink" title="sort()和Math.random()"></a>sort()和Math.random()</h2><p>JS中，数组原生的sort方法采用的排序算法是<em>快速排序</em>，假设你写了这样一行代码：<br><figure class="highlight js"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">[<span class="number">1</span>, <span class="number">2</span>, <span class="number">7</span>, <span class="number">4</span>, <span class="number">5</span>].sort(<span class="function">(<span class="params">a, b</span>) =&gt;</span> &#123; <span class="built_in">console</span>.log(a, b);<span class="keyword">return</span> a &gt; b; &#125;)</span><br></pre></td></tr></table></figure></p>
<p>那么，你会在浏览器中看到如下执行结果：</p>
<p><img src="http://web-site-files.ashshen.cc/blog/font-end-question/arr-sort.png" alt="output"></p>
<p>也就是说，sort方法执行时：从数组的第二个元素开始（假设它为m），依次把该元素（m）与它前面的元素（从arr[0]开始：n）进行比较，如果return的值小于0，则把该元素（m）插入到比较元素（n）前面，否则，继续与下一位元素比较（n的下一位）。</p>
<p>OK，回过头来我们看之前的代码。我们之前已经分析过：两份代码的区别在于每一次sort的源数组不同。</p>
<p>那么我们可以做一下这样的假设对于下面这样一段代码：<br><figure class="highlight bash"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">[0, 1, 2, 3, 4, 5].sort(() =&gt; Math.random() - 0.5);</span><br></pre></td></tr></table></figure></p>
<p>如果要得到形如[x, x, x, x, x, 0]这样的数组（也就是0在最后一位），需要<strong>5次Math.random() - 0.5的值都大于0</strong>，也就是说概率大概是：0.5^5 = 3.125%左右。而如果每次sort的数组都是上一次sort之后的数组的话，第n次得到[x, x, x, x, x, 0]的几率则会大大增加。</p>
<p>PS：这两份代码就好比给你1000个游戏币，第一份代码代表你每次死了只能从第一关重新开始，第二份代码则代表你可以从已经上次通过的关继续玩，很明显，通关的概率有很大的差别。</p>
<p>所以，当循环的次数越多，第二份代码得到数组混乱程度也就越大，当我们对其取平均值时，则会发现最后得到的res数组各个元素值会很平均。</p>
<p>以下为t = 10, t = 100, t = 1000, t = 10000, t =100000时两份代码执行结果：</p>
<p><img src="http://web-site-files.ashshen.cc/blog/font-end-question/final-result.png" alt="result"></p>
<p>可以看到，t越大，这样的特征是越明显的。</p>

  </div>
</article>



        
          <div id="footer-post-container">
  <div id="footer-post">

    <div id="nav-footer" style="display: none">
      <ul>
         
          <li><a href="/">首页</a></li>
         
          <li><a href="/about/">关于</a></li>
         
          <li><a href="/archives/">归档</a></li>
         
          <li><a href="/projects_url">项目</a></li>
        
      </ul>
    </div>

    <div id="toc-footer" style="display: none">
      <ol class="toc"><li class="toc-item toc-level-2"><a class="toc-link" href="#多了一个slice-0"><span class="toc-number">1.</span> <span class="toc-text">多了一个slice(0)</span></a></li><li class="toc-item toc-level-2"><a class="toc-link" href="#sort-和Math-random"><span class="toc-number">2.</span> <span class="toc-text">sort()和Math.random()</span></a></li></ol>
    </div>

    <div id="share-footer" style="display: none">
      <ul>
  <li><a class="icon" href="http://www.facebook.com/sharer.php?u=http://yoursite.com/2018/04/27/fe-question/"><i class="fab fa-facebook fa-lg" aria-hidden="true"></i></a></li>
  <li><a class="icon" href="https://twitter.com/share?url=http://yoursite.com/2018/04/27/fe-question/&text=一道前端面试题"><i class="fab fa-twitter fa-lg" aria-hidden="true"></i></a></li>
  <li><a class="icon" href="http://www.linkedin.com/shareArticle?url=http://yoursite.com/2018/04/27/fe-question/&title=一道前端面试题"><i class="fab fa-linkedin fa-lg" aria-hidden="true"></i></a></li>
  <li><a class="icon" href="https://pinterest.com/pin/create/bookmarklet/?url=http://yoursite.com/2018/04/27/fe-question/&is_video=false&description=一道前端面试题"><i class="fab fa-pinterest fa-lg" aria-hidden="true"></i></a></li>
  <li><a class="icon" href="mailto:?subject=一道前端面试题&body=Check out this article: http://yoursite.com/2018/04/27/fe-question/"><i class="fas fa-envelope fa-lg" aria-hidden="true"></i></a></li>
  <li><a class="icon" href="https://getpocket.com/save?url=http://yoursite.com/2018/04/27/fe-question/&title=一道前端面试题"><i class="fab fa-get-pocket fa-lg" aria-hidden="true"></i></a></li>
  <li><a class="icon" href="http://reddit.com/submit?url=http://yoursite.com/2018/04/27/fe-question/&title=一道前端面试题"><i class="fab fa-reddit fa-lg" aria-hidden="true"></i></a></li>
  <li><a class="icon" href="http://www.stumbleupon.com/submit?url=http://yoursite.com/2018/04/27/fe-question/&title=一道前端面试题"><i class="fab fa-stumbleupon fa-lg" aria-hidden="true"></i></a></li>
  <li><a class="icon" href="http://digg.com/submit?url=http://yoursite.com/2018/04/27/fe-question/&title=一道前端面试题"><i class="fab fa-digg fa-lg" aria-hidden="true"></i></a></li>
  <li><a class="icon" href="http://www.tumblr.com/share/link?url=http://yoursite.com/2018/04/27/fe-question/&name=一道前端面试题&description="><i class="fab fa-tumblr fa-lg" aria-hidden="true"></i></a></li>
</ul>

    </div>

    <div id="actions-footer">
        <a id="menu" class="icon" href="#" onclick="$('#nav-footer').toggle();return false;"><i class="fas fa-bars fa-lg" aria-hidden="true"></i> 菜单</a>
        <a id="toc" class="icon" href="#" onclick="$('#toc-footer').toggle();return false;"><i class="fas fa-list fa-lg" aria-hidden="true"></i> 目录</a>
        <a id="share" class="icon" href="#" onclick="$('#share-footer').toggle();return false;"><i class="fas fa-share-alt fa-lg" aria-hidden="true"></i> 分享</a>
        <a id="top" style="display:none" class="icon" href="#" onclick="$('html, body').animate({ scrollTop: 0 }, 'fast');"><i class="fas fa-chevron-up fa-lg" aria-hidden="true"></i> 返回顶部</a>
    </div>

  </div>
</div>

        
        <footer id="footer">
  <div class="footer-left">
    Copyright &copy; 2018 Ash
  </div>
  <div class="footer-right">
    <nav>
      <ul>
         
          <li><a href="/">首页</a></li>
         
          <li><a href="/about/">关于</a></li>
         
          <li><a href="/archives/">归档</a></li>
         
          <li><a href="/projects_url">项目</a></li>
        
      </ul>
    </nav>
  </div>
</footer>

    </div>
</body>
</html>
<!-- styles -->
<link rel="stylesheet" href="/lib/font-awesome/css/all.min.css">
<link rel="stylesheet" href="/lib/justified-gallery/css/justifiedGallery.min.css">

<!-- jquery -->
<script src="/lib/jquery/jquery.min.js"></script>
<script src="/lib/justified-gallery/js/jquery.justifiedGallery.min.js"></script>
<script src="/js/main.js"></script>
<!-- search -->

<!-- Google Analytics -->

<!-- Baidu Analytics -->

<!-- Disqus Comments -->



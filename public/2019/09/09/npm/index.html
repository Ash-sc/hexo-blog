<!DOCTYPE html><html lang="zh-CN"><head><meta name="generator" content="Hexo 3.8.0"><meta charset="UTF-8"><meta http-equiv="X-UA-Compatible" content="IE=edge"><meta name="viewport" content="width=device-width, initial-scale=1, maximum-scale=1"><meta name="description" content="å‰ç«¯ç§ƒå¤´æŒ‡å—ä¹‹npm"><meta name="keywords" content="npm,node"><meta name="author" content="Ash"><meta name="copyright" content="Ash"><title>å‰ç«¯ç§ƒå¤´æŒ‡å—ä¹‹npm | å°±åœ¨è®°å¿†é‡Œç”»ä¸€ä¸ªçŒ¹ğŸ¦”</title><link rel="shortcut icon" href="/img/favicon.ico"><link rel="stylesheet" href="/css/index.css?version=1.6.1"><link rel="stylesheet" href="https://cdn.jsdelivr.net/npm/font-awesome@latest/css/font-awesome.min.css?version=1.6.1"><link rel="dns-prefetch" href="https://cdn.staticfile.org"><link rel="dns-prefetch" href="https://cdn.bootcss.com"><link rel="dns-prefetch" href="https://creativecommons.org"><script>var GLOBAL_CONFIG = { 
  root: '/',
  algolia: undefined,
  localSearch: undefined,
  copy: {
    success: 'Copy successfully',
    error: 'Copy error',
    noSupport: 'The browser does not support'
  }
} </script></head><body><i class="fa fa-arrow-right" id="toggle-sidebar" aria-hidden="true"></i><div id="sidebar"><div class="toggle-sidebar-info text-center"><span data-toggle="Toggle article">Toggle site</span><hr></div><div class="sidebar-toc"><div class="sidebar-toc__title">Catalog</div><div class="sidebar-toc__progress"><span class="progress-notice">You've read</span><span class="progress-num">0</span><span class="progress-percentage">%</span><div class="sidebar-toc__progress-bar"></div></div><div class="sidebar-toc__content"><ol class="toc"><li class="toc-item toc-level-3"><a class="toc-link" href="#TL-DR"><span class="toc-number">1.</span> <span class="toc-text">TL;DR</span></a></li><li class="toc-item toc-level-3"><a class="toc-link" href="#ä¸€ã€npmå‘½ä»¤"><span class="toc-number">2.</span> <span class="toc-text">ä¸€ã€npmå‘½ä»¤</span></a><ol class="toc-child"><li class="toc-item toc-level-4"><a class="toc-link" href="#0-npm-install"><span class="toc-number">2.1.</span> <span class="toc-text">0. npm install</span></a><ol class="toc-child"><li class="toc-item toc-level-5"><a class="toc-link" href="#0-0-from-tarball"><span class="toc-number">2.1.1.</span> <span class="toc-text">0-0. from tarball</span></a></li><li class="toc-item toc-level-5"><a class="toc-link" href="#0-1-from-folder"><span class="toc-number">2.1.2.</span> <span class="toc-text">0-1. from folder</span></a></li><li class="toc-item toc-level-5"><a class="toc-link" href="#0-2-from-http-s-url"><span class="toc-number">2.1.3.</span> <span class="toc-text">0-2. from http(s) url</span></a></li><li class="toc-item toc-level-5"><a class="toc-link" href="#0-3-from-git-url"><span class="toc-number">2.1.4.</span> <span class="toc-text">0-3. from git url</span></a></li></ol></li><li class="toc-item toc-level-4"><a class="toc-link" href="#1-npm-repo-bugs"><span class="toc-number">2.2.</span> <span class="toc-text">1. npm repo/bugs</span></a></li><li class="toc-item toc-level-4"><a class="toc-link" href="#2-npm-docsï¼ˆnpm-homeï¼‰"><span class="toc-number">2.3.</span> <span class="toc-text">2. npm docsï¼ˆnpm homeï¼‰</span></a></li><li class="toc-item toc-level-4"><a class="toc-link" href="#3-npm-ci"><span class="toc-number">2.4.</span> <span class="toc-text">3. npm ci</span></a></li><li class="toc-item toc-level-4"><a class="toc-link" href="#4-npm-shrinkwrap"><span class="toc-number">2.5.</span> <span class="toc-text">4. npm shrinkwrap</span></a></li></ol></li><li class="toc-item toc-level-3"><a class="toc-link" href="#äºŒã€dependency"><span class="toc-number">3.</span> <span class="toc-text">äºŒã€dependency</span></a><ol class="toc-child"><li class="toc-item toc-level-4"><a class="toc-link" href="#1-dependencieså’ŒdevDependencies"><span class="toc-number">3.1.</span> <span class="toc-text">1. dependencieså’ŒdevDependencies</span></a></li><li class="toc-item toc-level-4"><a class="toc-link" href="#2-peerDependencies"><span class="toc-number">3.2.</span> <span class="toc-text">2. peerDependencies</span></a></li><li class="toc-item toc-level-4"><a class="toc-link" href="#3-bundleDependencies"><span class="toc-number">3.3.</span> <span class="toc-text">3. bundleDependencies</span></a></li><li class="toc-item toc-level-4"><a class="toc-link" href="#4-optionalDependencies"><span class="toc-number">3.4.</span> <span class="toc-text">4. optionalDependencies</span></a></li></ol></li><li class="toc-item toc-level-3"><a class="toc-link" href="#å°ç»“"><span class="toc-number">4.</span> <span class="toc-text">å°ç»“</span></a></li></ol></div></div><div class="author-info hide"><div class="author-info__avatar text-center"><img class="lazy" data-src="/img/avatar.jpg"></div><div class="author-info__name text-center">Ash</div><div class="author-info__description text-center"></div><div class="follow-button"><a href="https://github.com/Ash-sc">Github</a></div><hr><div class="author-info-articles"><a class="author-info-articles__archives article-meta" href="/archives"><span class="pull-left">Articles</span><span class="pull-right">28</span></a><a class="author-info-articles__tags article-meta" href="/tags"><span class="pull-left">Tags</span><span class="pull-right">41</span></a><a class="author-info-articles__categories article-meta" href="/categories"><span class="pull-left">Categories</span><span class="pull-right">21</span></a></div></div></div><div id="content-outer"><div class="no-bg" id="top-container"><div id="page-header"><span class="pull-left"> <a id="site-name" href="/">å°±åœ¨è®°å¿†é‡Œç”»ä¸€ä¸ªçŒ¹ğŸ¦”</a></span><i class="fa fa-bars toggle-menu pull-right" aria-hidden="true"></i><span class="pull-right menus"><a class="site-page" href="/">Home</a><a class="site-page" href="/archives">Archives</a><a class="site-page" href="/tags">Tags</a><a class="site-page" href="/categories">Categories</a></span></div><div id="post-info"><div id="post-title">å‰ç«¯ç§ƒå¤´æŒ‡å—ä¹‹npm</div><div id="post-meta"><time class="post-meta__date"><i class="fa fa-calendar" aria-hidden="true"></i> 2019-09-09</time><span class="post-meta__separator">|</span><i class="fa fa-inbox post-meta__icon" aria-hidden="true"></i><a class="post-meta__categories" href="/categories/node/">node</a><span class="post-meta__separator">|</span><i class="fa fa-comment-o post-meta__icon" aria-hidden="true"></i><a href="/2019/09/09/npm/#disqus_thread"><span class="disqus-comment-count" data-disqus-identifier="2019/09/09/npm/"></span></a></div></div></div><div class="layout" id="content-inner"><article id="post"><div class="article-container" id="post-content"><meta name="generator" content="Hexo 3.8.0"><h3 id="TL-DR"><a href="#TL-DR" class="headerlink" title="TL;DR"></a>TL;DR</h3><p>æœ¬æ–‡ä¸»è¦ä»‹ç»ï¼šnpm installå¯ä»¥å®‰è£…æ¥è‡ªå“ªäº›é€”å¾„çš„åŒ…ã€ä¸€äº›npmä¸å¸¸ç”¨çš„å‘½ä»¤ï¼ˆrepoã€docsã€ciã€shrinkwrapç­‰ï¼‰ã€package.jsonä¸­çš„å„ç§dependencyï¼ˆdependenciesã€devã€peerã€bundleã€optionalï¼‰ã€‚</p>
<a id="more"></a>
<h3 id="ä¸€ã€npmå‘½ä»¤"><a href="#ä¸€ã€npmå‘½ä»¤" class="headerlink" title="ä¸€ã€npmå‘½ä»¤"></a>ä¸€ã€npmå‘½ä»¤</h3><p>npmå‘½ä»¤ä¸­ï¼Œæˆ‘ä»¬æœ€å¸¸ç”¨çš„å°±æ˜¯<code>npm install/init/start/run</code>ä¹‹ç±»ã€‚å…¶å®é™¤æ­¤ä¹‹å¤–ï¼Œnpm cliè¿˜å·å·åœ°æ”¯æŒä¸€äº›æ¯”è¾ƒæœ‰æ„æ€çš„npmå‘½ä»¤ã€‚</p>
<h4 id="0-npm-install"><a href="#0-npm-install" class="headerlink" title="0. npm install"></a>0. npm install</h4><p>æˆ‘ä»¬å¯èƒ½æ¯å¤©éƒ½ä¼šé‡åˆ°è¿™æ ·çš„æƒ…å†µï¼Œå½“æˆ‘ä»¬<code>npm install</code>å®‰è£…äº†ä¸€ä¸ªä¸å­˜åœ¨çš„åŒ…æ—¶ï¼Œnpmä¼šæŠ›å‡ºè¿™æ ·ä¸€ä¸ª404é”™è¯¯ï¼š</p>
<p><img alt="npm install error" class="lazy" data-src="http://fe-share.ashshen.cc/npm/npm%20install%20error.png"></p>
<p>ä½†æ˜¯ï¼Œä½ æœ‰æ²¡æœ‰æ³¨æ„åˆ°è¿‡Error infoä¸­çš„noticeï¼š</p>
<blockquote>
<p>Note that you can also install from a tarball, folder, http url, or git url.</p>
</blockquote>
<p>å…¶å®ï¼Œ<code>npm install</code>å…¶å®ä¸ä»…ä»…å¯ä»¥ä»<code>npm registry</code>å®‰è£…åŒ…ï¼Œè¿˜å¯ä»¥é€šè¿‡å…¶ä»–æ–¹å¼å®‰è£…packageã€‚</p>
<p>æ¯”å¦‚ï¼š</p>
<h5 id="0-0-from-tarball"><a href="#0-0-from-tarball" class="headerlink" title="0-0. from tarball"></a>0-0. from tarball</h5><p>æˆ‘ä»¬å…ˆç”¨<code>npm view react</code>è·å–åˆ°reactæœ€æ–°ç‰ˆçš„tarballåœ°å€ã€‚</p>
<p><img alt="npm view info" class="lazy" data-src="http://fe-share.ashshen.cc/npm/npm%20view%20info.png"></p>
<p>æŠŠdistæè¿°ä¸‹çš„tarballä¸‹è½½åˆ°æœ¬åœ°åï¼Œæˆ‘ä»¬ä½¿ç”¨<code>npm install ./react-16.9.0.tgz</code>æ¥è¿›è¡Œå®‰è£…ã€‚</p>
<p><img alt="npm install with local tarball" class="lazy" data-src="http://fe-share.ashshen.cc/npm/npm%20install%20local%20tarball.png"></p>
<p>å®‰è£…å®Œæˆåï¼Œåœ¨package.jsonä¸­å¯ä»¥çœ‹åˆ°reactå€¼ä¸ºfileåè®®åœ°å€ã€‚</p>
<p><img alt="packagejson with local tarball" class="lazy" data-src="http://fe-share.ashshen.cc/npm/packagejson-with-local-tarball.png"></p>
<p><code>npm install tarball</code>åœ¨ä¸æƒ³å‘åŒ…åˆ°npmæºæˆ–è€…éœ€è¦ç¦»çº¿å®‰è£…æ—¶æ¯”è¾ƒæœ‰ç”¨ï¼Œä½†æ˜¯åŒæ—¶éœ€è¦é¢å¤–çš„å¯¹åŒ…è¿›è¡Œç»´æŠ¤ï¼Œä¸ç„¶å°±æ˜¯ç‰ˆæœ¬é”å®šäº†ã€‚</p>
<h5 id="0-1-from-folder"><a href="#0-1-from-folder" class="headerlink" title="0-1. from folder"></a>0-1. from folder</h5><p>æˆ‘ä»¬ä¹Ÿå¯ä»¥ä»ä¸€ä¸ªæœ¬åœ°æ–‡ä»¶å¤¹å®‰è£…packageï¼Œæ¯”å¦‚ï¼šæˆ‘ä»¬åœ¨~ç›®å½•ä¸‹æ–°å»ºäº†ä¸€ä¸ª<code>demo-pkg</code>çš„æ–‡ä»¶å¤¹ï¼Œå¹¶ä¸”ä½¿ç”¨<code>npm init --yes</code>åˆå§‹åŒ–å®ƒã€‚</p>
<p>ç„¶åï¼Œæˆ‘ä»¬å°±å¯ä»¥ä½¿ç”¨<code>npm install ~/demo-pkg</code>æ¥å®‰è£…åˆšåˆšæ–°å»ºçš„<code>demo-pkg</code>å•¦ã€‚</p>
<p><img alt="npm install folder" class="lazy" data-src="http://fe-share.ashshen.cc/npm/npm%20install%20folder.png"></p>
<p>å®‰è£…å®Œæˆä¹‹ååœ¨package.jsonä¸­çš„è¡¨ç°ä¸ºä¸€ä¸ªç›¸å¯¹è·¯å¾„çš„fileåè®®é“¾æ¥ã€‚</p>
<p><img alt="package json with file" class="lazy" data-src="http://fe-share.ashshen.cc/npm/package-json-with-file.png"></p>
<p><code>npm install tarball</code>å¯ç”¨äºåœ¨æœ¬åœ°è°ƒè¯•æœªå‘å¸ƒçš„npmåŒ…ã€‚</p>
<h5 id="0-2-from-http-s-url"><a href="#0-2-from-http-s-url" class="headerlink" title="0-2. from http(s) url"></a>0-2. from http(s) url</h5><p>åœ¨å®‰è£…tarballç¤ºä¾‹ä¸­ï¼Œæˆ‘ä»¬ä½¿ç”¨<code>npm view react</code>è·å–åˆ°äº†reactæœ€æ–°ç‰ˆæœ¬çš„tarball urlåœ°å€ã€‚æˆ‘ä»¬ä¹Ÿå¯ä»¥ç›´æ¥ç”¨<code>npm install https://registry.npmjs.org/react/-/react-16.9.0.tgz</code>å®‰è£…reactã€‚</p>
<p><img alt="npm install tarball" class="lazy" data-src="http://fe-share.ashshen.cc/npm/npm%20install%20tarball.png"></p>
<p>reactå®‰è£…æˆåŠŸåï¼Œpackage.jsonä¸­è¡¨ç°ä¸ºï¼š</p>
<p><img alt="package.json" class="lazy" data-src="http://fe-share.ashshen.cc/npm/packagejson.png"></p>
<p>å¯ä»¥çœ‹åˆ°reactçš„å€¼æŒ‡å‘çš„æ˜¯installçš„urlåœ°å€ã€‚</p>
<p><code>npm install url</code>å¯ç”¨äºï¼šä¸æƒ³å°†åŒ…å‘å¸ƒåˆ°npmï¼Œä½†æ˜¯åˆæƒ³è®©å›¢é˜Ÿæˆ–å…¶ä»–æˆå‘˜èƒ½å¤Ÿå®‰è£…æ­¤pkgã€‚</p>
<h5 id="0-3-from-git-url"><a href="#0-3-from-git-url" class="headerlink" title="0-3. from git url"></a>0-3. from git url</h5><p><code>npm install</code>è¿˜å¯ä»¥ä»gitæ¥å®‰è£…åŒ…ã€‚ä»¥momentä¸ºä¾‹ï¼Œæˆ‘ä»¬å¯ä»¥é€šè¿‡<code>npm install https://github.com/moment/moment.git</code>æ¥è¿›è¡Œå®‰è£…ã€‚</p>
<p><img alt="npm install git url" class="lazy" data-src="http://fe-share.ashshen.cc/npm/npm%20install%20url.png"></p>
<p>æ­¤æ—¶åœ¨package.jsonä¸­çš„è¡¨ç°ä¸ºï¼š</p>
<p><img alt="packagejson with git url" class="lazy" data-src="http://fe-share.ashshen.cc/npm/packagejson-with-url.png"></p>
<p>ä»¥ä¸Šå‡ ç§æ–¹å¼éƒ½å¯ä»¥ç”¨æ¥å®‰è£…packageï¼Œå¯æ ¹æ®å…·ä½“ä½¿ç”¨åœºæ™¯è‡ªè¡Œé€‰æ‹©ï¼›å½“ç„¶ï¼Œåœ¨å¹³æ—¶æ­£å¸¸çš„ä¸šåŠ¡å¼€å‘è¿‡ç¨‹ä¸­æˆ‘ä»¬è¿˜æ˜¯å°½é‡ä½¿ç”¨registryæ¥è¿›è¡Œpackageå®‰è£…ã€‚</p>
<p>ä¸‹é¢æˆ‘ä»¬æ¥çœ‹ä¸€äº›npmæ”¯æŒçš„ä¸€äº›ä¸å¸¸ç”¨çš„å‘½ä»¤ï¼š</p>
<h4 id="1-npm-repo-bugs"><a href="#1-npm-repo-bugs" class="headerlink" title="1. npm repo/bugs"></a>1. npm repo/bugs</h4><p>å½“æˆ‘ä»¬é‡åˆ°äº†ä¸€ä¸ªå…³äºæŸä¸ªnpmçš„ä½¿ç”¨é—®é¢˜æ—¶ï¼Œæˆ‘ä»¬çš„é€šå¸¸åšæ³•å¯èƒ½æ˜¯çœ‹ä¸€ä¸‹è¿™ä¸ªåŒ…çš„githubä¸Šæ˜¯å¦æœ‰ç±»ä¼¼çš„issueã€‚</p>
<p>äºæ˜¯æˆ‘ä»¬å¯èƒ½ä¼šè¿™ä¹ˆåšï¼šæ‰“å¼€æµè§ˆå™¨ â†’ googleå…³é”®å­—åŒ…å github â†’ è®¿é—®githubé¡µé¢ã€‚</p>
<p>å…¶å®ï¼Œè¿™æ—¶å€™æˆ‘ä»¬å¯ä»¥åœ¨terminalä¸­ç›´æ¥è¾“å…¥ï¼š<code>npm repo <pkg name=""></pkg></code>ï¼Œè¿™æ—¶æµè§ˆå™¨å°±ä¼šè‡ªåŠ¨æ‰“å¼€è¯¥npmåŒ…åœ¨<code>package.json</code>ä¸­çš„è®¾ç½®çš„github repoé¡µé¢å•¦ã€‚å½“ç„¶ï¼Œä¹Ÿå¯ä»¥åœ¨terminalä¸­è¾“å…¥<code>npm bugs <pkg name=""></pkg></code>ç›´æ¥è·³è½¬åˆ°github repoé¡µé¢issueæ¨¡å—ã€‚</p>
<p>æ€ä¹ˆæ ·ï¼Œæ˜¯ä¸æ˜¯å¾ˆæ–¹ä¾¿ã€‚</p>
<h4 id="2-npm-docsï¼ˆnpm-homeï¼‰"><a href="#2-npm-docsï¼ˆnpm-homeï¼‰" class="headerlink" title="2. npm docsï¼ˆnpm homeï¼‰"></a>2. npm docsï¼ˆnpm homeï¼‰</h4><p>ä½œä¸ºä¸€ä¸ªå‰ç«¯ç¨‹åºçŒ¿ï¼Œå¦‚æœä½ å—¦ä½ åœ¨å¼€å‘ä¸­å·²ç»ä¸éœ€è¦<code>lodash</code>ã€<code>momentjs</code>çš„æ–‡æ¡£äº†ï¼Œæˆ‘è¿˜æ˜¯æ¯”è¾ƒç›¸ä¿¡çš„ï¼›ä½†æ˜¯ä½ å¦‚æœè¯´ä½ å·²ç»ä¸éœ€è¦<code>echarts</code>ã€<code>webpack</code>çš„æ–‡æ¡£çš„è¯â€¦ï¼Œè¯·ç•™ä¸‹æ‚¨çš„ç®€å†å’Œè”ç³»æ–¹å¼ã€‚</p>
<p><code>npm docs <pkg name=""></pkg></code>æ­£æ˜¯ä¸ºäº†è¿™æ ·çš„åœºæ™¯è€Œå­˜åœ¨çš„ã€‚ä¾‹å¦‚ï¼šåœ¨terminalä¸­è¾“å…¥<code>npm docs echarts</code>å³å¯è°ƒç”¨æµè§ˆå™¨æ‰“å¼€echartsçš„å®˜æ–¹æ–‡æ¡£é¦–é¡µäº†ã€‚</p>
<p>PSï¼šè¿™é‡Œéœ€è¦æ³¨æ„çš„æ˜¯ï¼š<code>npm repo</code>å’Œ<code>npm docs</code>èƒ½å¤Ÿè°ƒç”¨æµè§ˆå™¨æ‰“å¼€é¡µé¢çš„å‰ææ˜¯è¯¥npmåŒ…çš„ä½œè€…åœ¨package.jsonæŒ‡å®šäº†åŒ…çš„ä¸»é¡µï¼ˆhomepageå±æ€§ï¼‰ã€‚</p>
<h4 id="3-npm-ci"><a href="#3-npm-ci" class="headerlink" title="3. npm ci"></a>3. npm ci</h4><p><code>npm ci</code>çš„ä½œç”¨ç±»ä¼¼äº<code>npm install</code>ï¼Œä¸è¿‡å®ƒä¸èƒ½æºå¸¦åŒ…åã€‚</p>
<p><code>npm ci</code>ä¸€èˆ¬ç”¨äºæµ‹è¯•å¹³å°ï¼ŒæŒç»­é›†æˆå’Œéƒ¨ç½²ä¸€ç±»çš„è‡ªåŠ¨åŒ–ç¯å¢ƒï¼Œé€šè¿‡è·³è¿‡æŸäº›é¢å‘ç”¨æˆ·çš„åŠŸèƒ½ï¼Œå®ƒå¯ä»¥æ¯”å¸¸è§„çš„npmå®‰è£…å¿«å¾ˆå¤šï¼ŒåŒæ—¶ï¼Œå®ƒä¹Ÿä¼šæ›´åŠ çš„ä¸¥æ ¼ï¼Œå¯ä»¥æ•è·ç”±äºæœ¬åœ°å¢é‡å®‰è£…çš„å¼•èµ·çš„é”™è¯¯å’Œä¸ä¸€è‡´å¹¶æŠ›å‡ºå¼‚å¸¸ã€‚</p>
<p>æˆ‘ä»¬éƒ½çŸ¥é“npm5ä»¥åï¼Œå¢åŠ äº†<code>package-lock.json</code>æ–‡ä»¶ï¼Œè€Œ<code>npm ci</code>åˆ™è¦æ±‚é¡¹ç›®å¿…é¡»æœ‰<code>package-lock.json</code>æ–‡ä»¶æˆ–<code>npm-shrinkwrap.json</code>æ–‡ä»¶ã€‚</p>
<p>å¦‚æœ<code>package-lock.json</code>ä¸­çš„ä¾èµ–é¡¹ä¸<code>package.json</code>ä¸åŒ¹é…ï¼Œ<code>npm ci</code>ä¼šé€€å‡ºå¹¶æ˜¾ç¤ºé”™è¯¯ã€‚</p>
<p>å·²ç»å­˜åœ¨çš„<code>node_modules</code>æ–‡ä»¶å¤¹ä¼šåœ¨è¿è¡Œ<code>npm ci</code>æ—¶è‡ªåŠ¨åˆ é™¤ã€‚</p>
<p>è¿™æ ·ä¹Ÿå°±ä¿è¯äº†ä½¿ç”¨<code>npm ci</code>åœ¨å„ä¸ªç¯å¢ƒä¸‹å®‰è£…çš„pkgç‰ˆæœ¬éƒ½æ˜¯ä¸€è‡´çš„ã€‚</p>
<h4 id="4-npm-shrinkwrap"><a href="#4-npm-shrinkwrap" class="headerlink" title="4. npm shrinkwrap"></a>4. npm shrinkwrap</h4><p>ä¸Šé¢ciå‘½ä»¤ä¸­æåˆ°äº†<code>npm-shrinkwrap.json</code>æ–‡ä»¶ï¼Œ<code>npm-shrinkwrap.json</code>æ–‡ä»¶å®é™…ä¸Šä¹Ÿæ˜¯npmä¸ºäº†ä¾èµ–åŒ…é”å®šè€Œè®¾è®¡çš„ã€‚<br>å¹¶ä¸”<code>npm shrinkwrap</code>å…¶å®å¾ˆæ—©ä»¥å‰npmå°±æ”¯æŒäº†ï¼Œåªä¸è¿‡æˆ‘ä»¬å¤§å¤šå¯¹<code>package-lock.json</code>çš„ç†Ÿæ‚‰å¤šäº<code>npm-shrinkwrap.json</code>ã€‚</p>
<p><code>package-lock.json</code>ä¸<code>npm-shrinkwrap.json</code>çš„åŒºåˆ«åœ¨äºï¼š</p>
<ol>
<li><p>npmå¼ºåˆ¶<code>package-lock.json</code>ä¸ä¼šè¢«å‘å¸ƒï¼Œè€Œ<code>npm-shrinkwrap.json</code>ä¸å—é™åˆ¶ã€‚</p>
</li>
<li><p>åœ¨å­˜åœ¨<code>package-lock.json</code>çš„é¡¹ç›®ä¸­è¿è¡Œ<code>npm shrinkwrap</code>æ—¶ï¼Œåªä¼šæŠŠ<code>package-lock.json</code>é‡å‘½åä¸º<code>npm-shrinkwrap.json</code>ã€‚</p>
</li>
<li><p>ä¸¤ä¸ªæ–‡ä»¶åŒæ—¶å­˜åœ¨æ—¶ï¼Œä»¥<code>npm-shrinkwrap.json</code>ä¸ºå‡†ã€‚</p>
</li>
</ol>
<p><code>package-lock.json</code>æ˜¯npm5çš„æ–°ç‰¹æ€§ï¼Œå¹¶ä¸”ä¸å…·å¤‡å‘ä¸‹å…¼å®¹ï¼Œè€Œ<code>npm-shrinkwrap.json</code>åœ¨npm4æˆ–ä»¥ä¸‹å¯ç”¨ã€‚è¿™ä¹Ÿå°±èƒ½è§£é‡Šä¸ºä»€ä¹ˆ<code>npm-shrinkwrap.json</code>ä¼˜å…ˆçº§ä¼šæ›´é«˜äº†ã€‚</p>
<p>npmè¿˜æ”¯æŒä¸€äº›å…¶ä»–çš„å‘½ä»¤ï¼Œæ¯”å¦‚ï¼š</p>
<p><code>npm edit <pkg name=""></pkg></code>ï¼šå¯ä»¥ç¼–è¾‘å½“å‰é¡¹ç›®node_modulesä¸­å®‰è£…çš„åŒ…ï¼Œç¼–è¾‘æ—¶ä½¿ç”¨çš„ç¼–è¾‘å™¨é€šè¿‡åœ¨npm-configä¸­editorå­—æ®µé…ç½®ï¼ˆé»˜è®¤viï¼‰ã€‚åœ¨å‰ç«¯æ™®éä½¿ç”¨å·¥ç¨‹åŒ–æ„å»ºçš„å½“ä¸‹ï¼Œé™¤éä¿®æ”¹éªŒè¯ä¸€äº›ç¬¬ä¸‰æ–¹åº“çš„bugå¤–ï¼Œè¿˜æ˜¯æä¸æ¨èä½¿ç”¨è¿™ç§æ–¹å¼ç›´æ¥ä¿®æ”¹é¡¹ç›®å®‰è£…çš„npmåŒ…å†…å®¹çš„ã€‚</p>
<p><code>npm view</code>ï¼šå¯ä»¥æŸ¥çœ‹npmåŒ…çš„ä¿¡æ¯ã€‚æ¯”å¦‚<code>npm view moment@2.24.0</code>å¯ä»¥æŸ¥çœ‹moment2.24.0çš„ä¿¡æ¯ï¼›<code>npm view lodash devDependencies</code>å¯ä»¥æŸ¥çœ‹lodashæœ€æ–°ç‰ˆæœ¬çš„å¼€å‘ä¾èµ–ã€‚</p>
<p><code>npm ls</code>ï¼šæŸ¥çœ‹å½“å‰é¡¹ç›®<code>node_modules</code>ä¸­çš„ä¾èµ–æ ‘ã€‚</p>
<p>è¯´äº†è¿™ä¹ˆå¤šnpmå‘½ä»¤ï¼Œæˆ‘ä»¬ç°åœ¨æ¥è¯´è¯´package.jsonã€‚</p>
<h3 id="äºŒã€dependency"><a href="#äºŒã€dependency" class="headerlink" title="äºŒã€dependency"></a>äºŒã€dependency</h3><h4 id="1-dependencieså’ŒdevDependencies"><a href="#1-dependencieså’ŒdevDependencies" class="headerlink" title="1. dependencieså’ŒdevDependencies"></a>1. dependencieså’ŒdevDependencies</h4><p>å½“æˆ‘ä»¬çš„é¡¹ç›®åªæ˜¯ä¸€ä¸ªåŸºäºå·¥ç¨‹åŒ–æ„å»ºæœ€åè¾“å‡ºé™æ€æ–‡ä»¶çš„é¡¹ç›®æ—¶ï¼Œpackageä¾èµ–æ˜¯æ”¾åœ¨<code>dependencies</code>æˆ–<code>devDependencies</code>ä¸­å¹¶æ²¡æœ‰ä»€ä¹ˆåŒºåˆ«ã€‚</p>
<p>å½“ä½ çš„é¡¹ç›®æ˜¯ä¸€ä¸ªå‰åç«¯ä¸€ä½“çš„é¡¹ç›®æ—¶ï¼ˆæ¯”å¦‚server/ä¸­å­˜æ”¾åç«¯Nodeè„šæœ¬ï¼Œå…¶ä»–æ–‡ä»¶å¤¹ä¸ºå‰ç«¯å·¥ç¨‹ï¼‰ï¼Œé‚£ä¹ˆä½ å¯ä»¥æŠŠå‰ç«¯å·¥ç¨‹çš„é¡¹ç›®æ”¾åœ¨<code>devDependencies</code>ä¸­ï¼ŒNodeæœåŠ¡ä¸­ç”¨åˆ°çš„æœåŠ¡æ”¾åœ¨<code>dependencies</code>é‡Œï¼Œè¿™æ ·åœ¨éƒ¨ç½²ç”Ÿäº§ç¯å¢ƒæ—¶å¯ä»¥ä½¿ç”¨<code>npm install --production</code>åªå®‰è£…Nodeè¿è¡Œçš„ä¾èµ–ï¼Œå‡å°‘ä½“ç§¯ã€‚</p>
<p>å½“ä½ çš„é¡¹ç›®Aæ˜¯ä½œä¸ºä¸€ä¸ªnpm pkgéœ€è¦è¢«åˆ«äººå®‰è£…ä½¿ç”¨æ—¶ï¼šä½äºpkg Açš„<code>devDependencies</code>ä¸­çš„ä¾èµ–åœ¨Aè¢«<code>npm install</code>æ—¶æ˜¯ä¸ä¼šè¢«å®‰è£…çš„ã€‚æ¯”å¦‚ï¼šmomentçš„<code>devDependencies</code>ä¸­æœ‰gruntï¼Œå½“ä½ åœ¨é¡¹ç›®ä¸­ä½¿ç”¨<code>npm install moment</code>æ—¶ï¼Œnode_modulesä¸­æ˜¯ä¸ä¼šæœ‰gruntçš„ã€‚</p>
<h4 id="2-peerDependencies"><a href="#2-peerDependencies" class="headerlink" title="2. peerDependencies"></a>2. peerDependencies</h4><p><code>dependencies</code>ä¸<code>devDependencies</code>åœ¨å¼€å‘ä¸­ç»å¸¸å¯è§ï¼Œé‚£ä¹ˆ<code>peerDependencies</code>åˆæ˜¯ä¸ªä»€ä¹ˆé¬¼ï¼Ÿ</p>
<p><code>peerDependencies</code>çš„ä½œç”¨ç±»ä¼¼äºï¼šå¦‚æœä½ è£…äº†æˆ‘ï¼Œé‚£ä¹ˆä½ <strong>æœ€å¥½</strong>ä¹Ÿ<del>è£…ä¸€ä¸‹B</del>è£…ä¸€ä¸‹pkg Bã€‚</p>
<p>å½“pkg Açš„package.jsonä¸­æœ‰å¦‚ä¸‹<code>peerDependencies</code>æ—¶ï¼š</p>
<figure class="highlight json"><table><tbody><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br></pre></td><td class="code"><pre><span class="line">{</span><br><span class="line">    <span class="attr">"peerDependencies"</span>: {</span><br><span class="line">        <span class="attr">"B"</span>: <span class="string">"1.0.0"</span></span><br><span class="line">    }</span><br><span class="line">}</span><br></pre></td></tr></tbody></table></figure>
<p>æˆ‘ä»¬æ‰§è¡Œ<code>npm install A</code>åï¼Œ<code>node_modules</code>ä¸­çš„ç›®å½•ç»“æ„å¤§è‡´å¦‚ä¸‹ï¼š<br></p><figure class="highlight"><table><tbody><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br></pre></td><td class="code"><pre><span class="line">your-project</span><br><span class="line">â”œâ”€â”¬ node_modules</span><br><span class="line">â”‚ â”œâ”€â”€ A</span><br><span class="line">â”‚ â”œâ”€â”€ B@1.0.0</span><br></pre></td></tr></tbody></table></figure><p></p>
<p>å¦‚æœpkg Açš„<code>peerDependencies</code>æŒ‡å®šäº†pkg Bç‰ˆæœ¬ä¸º<code>1.0.0</code>ï¼ŒåŒæ—¶åœ¨your-projecté¡¹ç›®package.jsonåˆç‹¬ç«‹å®‰è£…äº†pkg Bçš„<code>1.1.0</code>ç‰ˆæœ¬ï¼Œé‚£ä¹ˆæ‰§è¡Œ<code>npm install A</code>å<code>node_modules</code>ä¼šæ˜¯è¿™æ ·ï¼š<br></p><figure class="highlight"><table><tbody><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br></pre></td><td class="code"><pre><span class="line">your-project</span><br><span class="line">â”œâ”€â”¬ node_modules</span><br><span class="line">â”‚ â”œâ”€â”€ A</span><br><span class="line">â”‚ â”œâ”€â”€ B@1.1.0</span><br></pre></td></tr></tbody></table></figure><p></p>
<p>è€Œç”±äºAè¯´<strong>æœ€å¥½</strong>å®‰è£…<a href="mailto:B@1.0.0" target="_blank" rel="noopener">B@1.0.0</a>ä½†æ˜¯æ²¡æœ‰å¯¹åº”ç‰ˆæœ¬è¢«å®‰è£…ï¼Œæ‰€ä»¥åœ¨terminalä¸­ä¼šæœ‰ä¸€è¡Œwarningçš„æç¤ºï¼š</p>
<p><img alt="peerDependencies notice" class="lazy" data-src="http://fe-share.ashshen.cc/npm/peer-notice.png"></p>
<p>ï¼ˆnpm3åŠä»¥ä¸Š<code>peerDependencies</code>æ‰ä¸ä¼šè¢«å¼ºåˆ¶å®‰è£…ï¼›å¦‚æœæ˜¯npm2çš„è¯ï¼Œ<code>peerDependencies</code>æ˜¯ä¼šéšç€<code>npm install</code>è¢«å¼ºåˆ¶å®‰è£…çš„ã€‚ï¼‰</p>
<h4 id="3-bundleDependencies"><a href="#3-bundleDependencies" class="headerlink" title="3. bundleDependencies"></a>3. bundleDependencies</h4><p>ä¹Ÿå«<em>bundledDependencies</em>å®ƒçš„å€¼æ˜¯ä¸€ä¸ªæ•°ç»„ã€‚</p>
<p>å½“æˆ‘ä»¬åœ¨test-npmè¿™ä¸ªæµ‹è¯•åŒ…çš„package.jsonä¸­æ·»åŠ momentå’Œreactä¸º<code>bundledDependencies</code>ç„¶å<code>npm publish</code>å‘å¸ƒã€‚</p>
<p><img alt="bundleDependencies" class="lazy" data-src="http://fe-share.ashshen.cc/npm/bundle-dependencies.png"></p>
<p>ç„¶åæˆ‘ä»¬åˆ†åˆ«ä¸‹è½½æ·»åŠ <code>bundleDependencies</code>å‰åçš„tarballï¼Œè§£å‹ã€‚</p>
<p><img alt="bundle diff" class="lazy" data-src="http://fe-share.ashshen.cc/npm/bundle-diff.png"></p>
<p>å¯ä»¥çœ‹åˆ°æ·»åŠ äº†<code>bundleDependencies</code>çš„ç‰ˆæœ¬ï¼ˆ1.0.0ï¼‰ä¸­ï¼Œä¼šå¤šå‡ºä¸€ä¸ªnode_modulesæ–‡ä»¶å¤¹ï¼Œæ–‡ä»¶å¤¹ä¸­æœ‰reactå’Œmomentä»¥åŠä»–ä»¬çš„<code>dependencies</code>ä¾èµ–ï¼Œè€Œæ²¡æœ‰æ·»åŠ <code>bundleDependencies</code>çš„ç‰ˆæœ¬ï¼ˆ1.0.0ï¼‰æ–‡ä»¶å¤¹ä¸­åˆ™åªæœ‰ä¸€ä¸ªpackage.jsonã€‚</p>
<p>åœ¨é¡¹ç›®ä¸­å®‰è£…æœ‰<code>bundleDependencies</code>çš„test-npmç‰ˆæœ¬æ—¶ï¼Œreactå’Œmomentå¹¶ä¸ä¼šè¢«å±•å¼€åˆ°é¡¹ç›®è‡ªèº«çš„node_modulesä¸­å»ï¼Œè€Œæ˜¯ä¾ç„¶å­˜åœ¨äºtest-npm/node_modules/ä¸­ã€‚</p>
<p><em>PS</em>ï¼š è¿™é‡Œæ¨èä¸€ä¸ªè½»é‡çš„ç§æœ‰npmä»“åº“å·¥å…·ï¼š<a href="https://github.com/verdaccio/verdaccio" target="_blank" rel="noopener">verdaccio</a>ï¼Œåªéœ€è¦<code>npm install -g verdaccio && verdaccio</code>å°±å¯ä»¥ç”¨ä¸€é”®æ­å»ºä¸€ä¸ªç§æœ‰npmä»“åº“ï¼Œå¯¹äºå¹³æ—¶çš„ä¸€äº›å¼€å‘æµ‹è¯•è¿˜æ˜¯æ¯”è¾ƒæœ‰ç”¨çš„ã€‚</p>
<h4 id="4-optionalDependencies"><a href="#4-optionalDependencies" class="headerlink" title="4. optionalDependencies"></a>4. optionalDependencies</h4><p>çœ‹åˆ°è¿™ä¸ªåå­—åº”è¯¥å°±èƒ½çŒœåˆ°<code>optionalDependencies</code>è¡¨ç¤ºçš„æ˜¯å¯é€‰çš„ä¾èµ–äº†ã€‚</p>
<p>æ¯”å¦‚ï¼šä½ åœ¨é¡¹ç›®ä¸­ä¾èµ–äº†ä¸€ä¸ªpkg Cï¼Œä½†æ˜¯ä½ åˆå¸Œæœ›æ— è®ºCæœ‰æ²¡æœ‰è¢«å®‰è£…ä½ çš„é¡¹ç›®éƒ½å¯ä»¥æ­£å¸¸è¿è¡Œï¼Œé‚£ä¹ˆä½ å¯ä»¥æŠŠCæ”¾åœ¨<code>optionalDependencies</code>ä¸­ã€‚</p>
<p><code>optionalDependencies</code>ä¸­çš„ä¾èµ–åŒ…ï¼Œå³ä½¿æ²¡æœ‰è¢«å®‰è£…æˆåŠŸï¼ˆæ¯”å¦‚ä¸å­˜åœ¨å¯¹åº”åŒ…åæˆ–ç‰ˆæœ¬ï¼‰ï¼Œ<code>npm install</code>æ—¶ä¹Ÿä¸ä¼šæŠ›å‡ºé”™è¯¯æç¤ºã€‚</p>
<h3 id="å°ç»“"><a href="#å°ç»“" class="headerlink" title="å°ç»“"></a>å°ç»“</h3><p>å…³äºnpmçš„çŸ¥è¯†ç‚¹è¿˜æœ‰å¾ˆå¤šå¾ˆå¤šï¼Œæ¯”å¦‚scriptsã€æ¯”å¦‚npxã€æ¯”å¦‚npmå„ç‰ˆæœ¬çš„å·®å¼‚ç‚¹ä»¥åŠè§£å†³çš„é—®é¢˜å’Œå¯¼è‡´çš„é—®é¢˜ï¼Œéƒ½æ˜¯å¾ˆæœ‰æ„æ€çš„ä¸œè¥¿ã€‚</p>
<p>ä¸è®ºæ˜¯æŒ‰éƒ¨å°±ç­çš„å•ƒæ–‡æ¡£è¿˜æ˜¯æ‡µæ‡µæ‡‚æ‡‚çš„çœ‹issueï¼Œåˆæˆ–è€…é€›è®ºå›ã€çœ‹åšå®¢ã€æœgoogleï¼Œä¸ç®¡å¦‚ä½•ï¼Œæˆ‘ä»¬éƒ½æ˜¯åœ¨ç§ƒå¤´çš„è·¯ä¸Šä¸€å»ä¸è¿”äº†ã€‚</p>
</div></article><div class="post-copyright"><div class="post-copyright__author"><span class="post-copyright-meta">Author: </span><span class="post-copyright-info"><a href="mailto:undefined">Ash</a></span></div><div class="post-copyright__type"><span class="post-copyright-meta">Link: </span><span class="post-copyright-info"><a href="https://ashshen.cc/2019/09/09/npm/">https://ashshen.cc/2019/09/09/npm/</a></span></div><div class="post-copyright__notice"><span class="post-copyright-meta">Copyright Notice: </span><span class="post-copyright-info">All articles in this blog are licensed under <a href="https://creativecommons.org/licenses/by-nc-sa/4.0/">CC BY-NC-SA 4.0</a> unless stating additionally.</span></div></div><div class="post-meta__tag-list"><a class="post-meta__tags" href="/tags/npm/">npm</a><a class="post-meta__tags" href="/tags/node/">node</a></div><div class="post-qr-code"><div class="post-qr-code-item"><img class="post-qr-code__img lazy" data-src="/img/alipay.png"><div class="post-qr-code__desc">alipay</div></div><div class="post-qr-code-item"><img class="post-qr-code__img lazy" data-src="/img/wechat.png"><div class="post-qr-code__desc">wechat</div></div></div><nav id="pagination"><div class="next-post pull-right"><a href="/2019/05/09/nginx-domain/"><span>nginxé…ç½®å¤šçº§åŸŸåæ³›è§£æ</span><i class="fa fa-chevron-right"></i></a></div></nav><div id="disqus_thread"></div><script>var unused = null;
var disqus_config = function () {
  this.page.url = 'https://ashshen.cc/2019/09/09/npm/';
  this.page.identifier = '2019/09/09/npm/';
  this.page.title = 'å‰ç«¯ç§ƒå¤´æŒ‡å—ä¹‹npm';
}
var d = document, s = d.createElement('script');
s.src = "https://" + 'ashshen-cc' +".disqus.com/embed.js";
s.setAttribute('data-timestamp', '' + +new Date());
(d.head || d.body).appendChild(s);</script><script id="dsq-count-scr" src="https://ashshen-cc.disqus.com/count.js" async></script></div></div><footer><div class="layout" id="footer"><div class="copyright">Â©2017 - 2019 By Ash</div><div class="framework-info"><span>Driven - </span><a href="http://hexo.io"><span>Hexo</span></a><span class="footer-separator">|</span><span>Theme - </span><a href="https://github.com/Molunerfinn/hexo-theme-melody"><span>Melody</span></a></div><div class="busuanzi"><script async src="//busuanzi.ibruce.info/busuanzi/2.3/busuanzi.pure.mini.js"></script><span id="busuanzi_container_page_pv"><i class="fa fa-file-o"></i><span id="busuanzi_value_page_pv"></span><span></span></span></div></div></footer><i class="fa fa-arrow-up" id="go-up" aria-hidden="true"></i><script src="https://cdn.jsdelivr.net/npm/animejs@latest/anime.min.js"></script><script src="https://cdn.jsdelivr.net/npm/jquery@latest/dist/jquery.min.js"></script><script src="https://cdn.jsdelivr.net/npm/@fancyapps/fancybox@latest/dist/jquery.fancybox.min.js"></script><script src="https://cdn.jsdelivr.net/npm/velocity-animate@latest/velocity.min.js"></script><script src="https://cdn.jsdelivr.net/npm/velocity-ui-pack@latest/velocity.ui.min.js"></script><script src="/js/utils.js?version=1.6.1"></script><script src="/js/fancybox.js?version=1.6.1"></script><script src="/js/sidebar.js?version=1.6.1"></script><script src="/js/copy.js?version=1.6.1"></script><script src="/js/fireworks.js?version=1.6.1"></script><script src="/js/transition.js?version=1.6.1"></script><script src="/js/scroll.js?version=1.6.1"></script><script src="/js/head.js?version=1.6.1"></script><script>if(/Android|webOS|iPhone|iPod|BlackBerry/i.test(navigator.userAgent)) {
  $('#nav').addClass('is-mobile')
  $('footer').addClass('is-mobile')
}</script><script>document.addEventListener("DOMContentLoaded", function() {
  var lazyloadImages;

  if ("IntersectionObserver" in window) {
    lazyloadImages = document.querySelectorAll(".lazy");
    var imageObserver = new IntersectionObserver(function(entries, observer) {
      entries.forEach(function(entry) {
        if (entry.isIntersecting) {
          var image = entry.target;
          image.src = image.dataset.src;
          image.classList.remove("lazy");
          imageObserver.unobserve(image);
        }
      });
    });

    lazyloadImages.forEach(function(image) {
      imageObserver.observe(image);
    });
  } else {  
    var lazyloadThrottleTimeout;
    lazyloadImages = document.querySelectorAll(".lazy");
    
    function lazyload () {
      if(lazyloadThrottleTimeout) {
        clearTimeout(lazyloadThrottleTimeout);
      }    

      lazyloadThrottleTimeout = setTimeout(function() {
        var scrollTop = window.pageYOffset;
        lazyloadImages.forEach(function(img) {
            if(img.offsetTop < (window.innerHeight + scrollTop)) {
              img.src = img.dataset.src;
              img.classList.remove('lazy');
            }
        });
        if(lazyloadImages.length == 0) { 
          document.removeEventListener("scroll", lazyload);
          window.removeEventListener("resize", lazyload);
          window.removeEventListener("orientationChange", lazyload);
        }
      }, 20);
    }

    document.addEventListener("scroll", lazyload);
    window.addEventListener("resize", lazyload);
    window.addEventListener("orientationChange", lazyload);
  }
})
</script></body></html>